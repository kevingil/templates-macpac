<TMPL_INCLUDE NAME="header.tmpl">
  <p class="breadcrumb-header">
    <a href="productCats.html">Back to Product Categories</a>
    <TMPL_IF NAME="breadcrumbtext1"> / <a href="category.html?<TMPL_VAR NAME="breadcrumblink1">">
      <TMPL_VAR NAME="breadcrumbtext1" escape=html></a></TMPL_IF>
    <TMPL_IF NAME="breadcrumbtext2"> / <a href="category.html?<TMPL_VAR NAME="breadcrumblink2">">
      <TMPL_VAR NAME="breadcrumbtext2" escape=html></a></TMPL_IF>
  </p>

  <div class="product-results-wrap">
    <div class="product-filters-wrap">

      <!-- filter bar for full size -->

      <details id="pagecontrols">
        <summary role="button" class="secondary"><b>Sort</b></summary>
        <article>
        <TMPL_INCLUDE NAME="pageControlsSelects.tmpl">
        </article>
      </details>


      <details id="filtercontainer" open>
        <summary role="button" class="secondary"><b>Filters</b></summary>
        <article>
        <TMPL_INCLUDE NAME="filters.tmpl">
        </article>
      </details>
    </div>

    <div class="product-filters-modal-wrap">
      <!-- modal for mobile site -->

      <button class="secondary" onClick="openModal('sort-dialog')">
        <b>Sort</b>
      </button>

      <dialog id="sort-dialog">
        <article>
          <header>
            <p>
              <strong>Sort</strong>
            </p>
          </header>

          <TMPL_INCLUDE NAME="pageControlsSelects.tmpl">

            <footer>
              <button className="secondary" onClick="closeModal('sort-dialog')">
                Cancel
              </button>
              <button>Confirm</button>
            </footer>
        </article>
      </dialog>

      <button class="secondary" onClick="openModal('filter-dialog')">
        <b>Filters</b>
      </button>

      <dialog id="filter-dialog">
        <article>
          <header>
            <p>
              <strong>Filter</strong>
            </p>
          </header>
          <TMPL_INCLUDE NAME="filters.tmpl">
            <footer>
              <button className="secondary" onClick="closeModal('filter-dialog')">
                Cancel
              </button>
              <button>Confirm</button>
            </footer>
        </article>
      </dialog>
    </div>


    <script>
      /*
* Modal
*
* Pico.css - https://picocss.com
* Copyright 2019-2023 - Licensed under MIT
*/

      // Config
      const isOpenClass = "modal-is-open";
      const openingClass = "modal-is-opening";
      const closingClass = "modal-is-closing";
      const animationDuration = 400; // ms
      let visibleModal = null;

      // Open modal
      const openModal = (modalID) => {
        let modal = document.getElementById(modalID);
        modal.setAttribute("open", true);
      };

      // Close modal
      const closeModal = (modalID) => {
        let modal = document.getElementById(modalID);
        visibleModal = null;
        setTimeout(() => {
          document.documentElement.classList.remove(closingClass, isOpenClass);
          modal.removeAttribute("open");
        }, animationDuration);
      };
    </script>



    <div class="products-wrap">
      <TMPL_INCLUDE NAME="productChunk.tmpl">
    </div>

    <script>
      // plus minus buttons handler
      // see productChunk.tmpl for buttons
      var plusButton = document.getElementsByClassName('plus-button');
      console.log(plusButton)
      var minusButton = document.getElementsByClassName('minus-button');
      console.log(minusButton)
    
      // add handler
      for (var i = 0; i < plusButton.length; i++){
        var currentButton = plusButton[i];

        currentButton.addEventListener('click',function(event){

          var buttonClicked = event.currentTarget;

          var input = buttonClicked.parentElement.children[2];
          console.log(buttonClicked);
          console.log(buttonClicked.parentElement);
          console.log(input);
          var calcVal = 0;

          if (isNaN(parseInt(input.value))){
            console.log("assign val if undef");
            input.value = calcVal;
          } else {
            input.value = parseInt(input.value) + 1;
          }
          
          console.log("CALC:" + input.value);
        })

      }

        // subtrac handler
        for (var i = 0; i < minusButton.length; i++){
        var currentButton = minusButton[i];
        currentButton.addEventListener('click',function(event){

          var buttonClicked = event.currentTarget;

          var input = buttonClicked.parentElement.children[2];
          console.log(buttonClicked);
          console.log(buttonClicked.parentElement);
          console.log(input);
          var calcVal = 0;

          if (isNaN(parseInt(input.value))){
            console.log("assign val if undef");
            input.value = calcVal;
          } else if (input.value<=0) {
            input.value = calcVal;
          } else {
            input.value = parseInt(input.value) - 1;
          }

          console.log("CALC:" + input.value);
        })
      }

    </script>

  </div>

  <p class="divider">&nbsp;</p>

  <div class="center" style="clear: both">
    <TMPL_INCLUDE NAME="salesNavs.tmpl">
  </div>

  <TMPL_INCLUDE NAME="jquery_favorite.tmpl">
    <TMPL_INCLUDE NAME="jquery_handleCart.tmpl">
      <TMPL_INCLUDE NAME="jquery_regHandleCart.tmpl">
        <TMPL_INCLUDE NAME="footer.tmpl">